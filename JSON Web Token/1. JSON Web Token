[+] INTRODUCTION:

* JSON Web Token are a storage mechanism to store data
* JWT provides encryption and Signature
* A common JWT has the following format:
        >_ base64(header).base64(data).base64(signature)
* The header contains the type of algorithm used to encrypt the auth
* The data is encoded in base64 and it is the centre part of the JWT
* The signature is the last part of the JWT


[+] HOW DOES JWT WORKS ?

* When the token is generated utilized by the web application
* The application first analyses the header and finds the encoding type implemented
* The signature is evaluted by the applcation by comparing the signature with the header
* If the signature doesnt match with the header, it will be neglected
* The signature is created by taking the header and data and signing it with the algorithm mentioned in the header
* A tweak in the signature will result in error
* The algorithms that were available in JWT were:
        >_ RSA 
        >_ Elliptic curves
        >_ HMAC
        >_ NONE


[+] VULNERABLITY:

* The NONE algorithm makes this JWT vulnerable
* We have a login page with JWT Enabled
* As the JWT is a base64 and has the fields seperated by the delemeter '.' The data is tampered
eyJhbGciOiJIUzIadasd1NiIsInR5cCI6IkpXUyJ9.eyJsb2dpbiI6ImN3cjNuY2giLCJpYXQiOiIxNTg4OTQ0MDM2In0.OWM0YmI2Y2JmZTJlZDY2YTgzNDdkZDdjMWNiZjlkMTFhNjkzOTI3NzVmMGIzOGJiYWNhY2Q1ZmI1MJe1nTI3OQ     #IGNORE THIS WILL NEVER BE THE SAME
* By decoding the first part, i.e., the header, we see the HS256 alogorithm used
* By decoding the data we see the username


[+] EXPLOITATION:

* The algorithm is changed from HS256 to NONE
* And the username in the data field is changed to the desired user
* Since the NONE algorithm is accepted by the JWT we have no problem
* Then the signature is removed as the signature is compared with the header
* When unchanged we have a signature of the algorithm HS256 and the header NONE which results in error
* So the algo is changed and the data is changed and the signature is removed the alterted string is base64
* The JWT token in response is replaced with the altered token and thus accessing assests is possible
